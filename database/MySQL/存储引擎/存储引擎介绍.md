# MySQL 体系结构
![[Pasted image 20250813032422.png]]

- 连接层
最上层是一些客户端和链接服务，主要完成一些类似于连接处理、授权认证、及相关的安全方案。服务器也会为安全接入的每个客户端验证它所具有的操作权限。
- 服务层
第二层架构主要完成大多数的核心服务功能，如SQL接口，并完成缓存的查询，SQL的分析和优化，部分内置函数的执行。所有跨存储引擎的功能也在这一层实现，如 过程、函数等。
- 引擎层
存储引擎真正的负责了MVSOL中数据的存储和提取，服务器通过API和存储引擎进行通信。不同的存储引擎具有不同的功能，这样我们可以根据自己的需要，来选取合适的存储引擎。
- 存储层
主要是将数据存储在文件系统之上，并完成与存储引擎的交互。
---
# 存储引擎

**存储引擎**（Storage Engine）是 MySQL 用来**管理表数据和索引的底层实现方式**，  
相当于数据库的“驱动内核”，决定了数据的**存储方式、索引结构、事务支持、锁机制**等特性。
是基于表的，不是基于库的，所以存储引擎也可称为表类型

---
#### 1️⃣ 存储引擎的作用

- 定义**数据存储结构**（比如用 B+ 树、哈希表等）
    
- 管理**索引**（不同引擎索引结构不同）
    
- 决定是否支持**事务**（ACID）
    
- 决定**锁的粒度**（表锁、行锁）
    
- 影响**性能**（读取速度、并发能力）

```sql
-- 查看当前数据库支持的存储引擎
SHOW ENGINES;

-- 创建表时指定存储引擎
CREATE TABLE test (
    id INT PRIMARY KEY,
    name VARCHAR(20)
) ENGINE=InnoDB;

-- 修改表的存储引擎
ALTER TABLE test ENGINE=MyISAM;
```
---
#### 2️⃣ MySQL 常见存储引擎对比

| 特性       | **InnoDB**（默认） | **MyISAM** | **Memory** |
| -------- | -------------- | ---------- | ---------- |
| **事务支持** | ✅ 支持           | ❌ 不支持      | ❌ 不支持      |
| **锁粒度**  | 行锁（并发高）        | 表锁         | 表锁         |
| **外键支持** | ✅ 支持           | ❌ 不支持      | ❌ 不支持      |
| **数据安全** | 高（崩溃可恢复）       | 低          | 数据断电丢失     |
| **读取速度** | 较快（支持缓存）       | 快（简单结构）    | 极快（内存存储）   |
| **适用场景** | 需要事务、并发高       | 只读或读多写少    | 临时表、缓存数据   |

![[Pasted image 20250813034129.png]]

---

|场景|推荐引擎|原因|
|---|---|---|
|银行转账、订单系统|InnoDB|支持事务，行锁并发高，崩溃可恢复|
|新闻、博客、搜索|MyISAM / InnoDB|MyISAM 读性能高且全文索引快；InnoDB 数据安全高|
|实时统计、临时缓存|Memory|全内存存储，速度极快，重启丢数据|
|大批量写入日志|MyISAM / InnoDB|MyISAM 写性能好；InnoDB 数据安全高|
|大型 OLTP 系统|InnoDB|行锁、高并发、事务支持|