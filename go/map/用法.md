
# ğŸ“˜  `map` è¯¦è§£

## 1. åŸºæœ¬æ¦‚å¿µ

- `map` æ˜¯ Go çš„ **å†…ç½®å“ˆå¸Œè¡¨**å®ç°ï¼Œç”¨æ¥å­˜å‚¨ **é”®å€¼å¯¹ (key â†’ value)**ã€‚

```go
func main() 
	m := make(map[string]int)          // åˆ›å»ºç©º map
	m2 := map[string]int{"a": 1, "b":2} // å­—é¢é‡åˆå§‹åŒ–
	fmt.Println(m["a"]) // è¾“å‡º: 1

	m1 := map[string]uint64{
		"a": 1,
		"b": 2,
		"c": 3,
		"d": 4,
	}
	fmt.Println(m1["c"]) // è¾“å‡º: 3
}
```

### 1. ç”¨ `make` åˆ›å»º

```go
m := make(map[string]int)
```

- **ç»“æœ**ï¼šåˆ›å»ºä¸€ä¸ª **ç©º map**ï¼Œåç»­éœ€è¦æ‰‹åŠ¨èµ‹å€¼ã€‚
    
- **ç”¨é€”**ï¼š
    - é€‚åˆå½“ä½ ä¸çŸ¥é“åˆå§‹é”®å€¼å¯¹ï¼Œä½†ä¹‹åä¼šåŠ¨æ€æ’å…¥ã€‚
    - å¯ä»¥æŒ‡å®šå®¹é‡ï¼ˆæå‡æ€§èƒ½ï¼‰ï¼š

```go
m := make(map[string]int, 10) // é¢„åˆ†é… 10 ä¸ªç©ºé—´
```
**ç‰¹ç‚¹**ï¼š

- å¿…é¡»ç”¨ `make`ï¼Œå¦åˆ™ `var m map[string]int` å¾—åˆ°çš„æ˜¯ `nil map`ï¼Œä¸€æ—¦èµ‹å€¼ä¼š panicã€‚

```go
var m map[string]int 
m["a"] = 1 // âŒ panic: assignment to entry in nil map
```
---
## 2. ç”¨å­—é¢é‡ç›´æ¥å£°æ˜å¹¶åˆå§‹åŒ–

```go
m1 := map[string]uint64{
	"a": 1,
	"b": 2,
	"c": 3,
	"d": 4,
}
```

- **ç»“æœ**ï¼šå£°æ˜æ—¶å°±æœ‰åˆå§‹å€¼ã€‚
- **ç”¨é€”**ï¼š
    - é€‚åˆ **ä¸€å¼€å§‹å°±çŸ¥é“åˆå§‹é”®å€¼å¯¹** çš„åœºæ™¯ã€‚
    - ä¸€èˆ¬ç”¨äºé…ç½®ã€å¸¸é‡è¡¨ã€é™æ€æ•°æ®ã€‚
- **ç‰¹ç‚¹**ï¼š
    - è¯­æ³•æ›´ç®€æ´ï¼Œå£°æ˜å³åˆå§‹åŒ–ã€‚
    - æ²¡æ³•ç›´æ¥æŒ‡å®šå®¹é‡ï¼Œå› ä¸ºå¤§å°å–å†³äºä½ å†™äº†å¤šå°‘é”®å€¼ã€‚
---
## 1. å¯ä»¥ä½œä¸º key çš„ç±»å‹

Go è¯­è¨€è§„èŒƒé‡Œï¼š

> Map types: The key type must be comparable, that is, it must support the equality operators == and != without causing a run-time panic.

æ‰€æœ‰æ”¯æŒ `==`ã€`!=` çš„ç±»å‹éƒ½å¯ä»¥å½“ä½œ keyï¼š

- **å¸ƒå°”å‹**ï¼š`bool`
    
- **æ•°å€¼å‹**ï¼š`int`ã€`uint`ã€`float`ï¼ˆè™½ç„¶æµ®ç‚¹æ•°èƒ½ç”¨ï¼Œä½†ä¸æ¨èï¼ŒåŸå› è§ä¸‹é¢ âš ï¸ï¼‰
    
- **å­—ç¬¦ä¸²**ï¼š`string`
    
- **æŒ‡é’ˆ**ï¼š`*T`
    
- **æ¥å£ç±»å‹**ï¼šåªè¦åº•å±‚çš„åŠ¨æ€å€¼æ˜¯å¯æ¯”è¾ƒçš„
    
- **ç»“æ„ä½“ï¼ˆstructï¼‰**ï¼šé‡Œé¢æ‰€æœ‰å­—æ®µéƒ½å¿…é¡»æ˜¯å¯æ¯”è¾ƒçš„
    
- **æ•°ç»„ï¼ˆarrayï¼‰**ï¼šå…ƒç´ å¿…é¡»æ˜¯å¯æ¯”è¾ƒçš„
    

ä¾‹å¦‚ï¼š
```go
m1 := map[int]string{1: "one"}
m2 := map[string]int{"a": 1}
m3 := map[[2]int]string{{1,2}: "point"}
m4 := map[struct{X, Y int}]string{{1,2}: "structKey"}
```
---
## 2. ä¸èƒ½ä½œä¸º key çš„ç±»å‹

ä»¥ä¸‹ç±»å‹å› ä¸º **ä¸å¯æ¯”è¾ƒ**ï¼Œæ‰€ä»¥ä¸èƒ½å½“ keyï¼š

- **åˆ‡ç‰‡ï¼ˆsliceï¼‰**
- **æ˜ å°„ï¼ˆmapï¼‰**
- **å‡½æ•°ï¼ˆfuncï¼‰**

å¦‚æœå†™ï¼š

```go
m := map[[]int]string{} // âŒ ç¼–è¯‘é”™è¯¯ï¼šinvalid map key type []int
```
---
## 3. ç‰¹æ®Šæƒ…å†µ âš ï¸

- **æµ®ç‚¹æ•° (`float32`, `float64`)** è™½ç„¶èƒ½å½“ keyï¼Œä½†å­˜åœ¨ **ç²¾åº¦å’Œ NaN é—®é¢˜**ï¼š
    
```go
m := map[float64]string{} m[0.1+0.2] = "x"  
fmt.Println(m[0.3])
// å¯èƒ½å–ä¸åˆ°ï¼Œå› ä¸ºäºŒè¿›åˆ¶ç²¾åº¦è¯¯å·®`
```
   ä¸€èˆ¬ä¸æ¨èç”¨ float ä½œä¸º keyã€‚
    
- **æ¥å£ç±»å‹ (interface{})** å¯ä»¥å½“ keyï¼Œä½†è¦ä¿è¯å­˜è¿›å»çš„å®é™…å€¼æ˜¯å¯æ¯”è¾ƒçš„ï¼Œå¦åˆ™è¿è¡Œæ—¶ä¼š panicã€‚
    
    `var m = map[interface{}]string{} m[[]int{1,2}] = "oops" // âŒ runtime panic: uncomparable type []int`

---
### . ä¸ºä»€ä¹ˆ map éå†æ˜¯æ— åºçš„ï¼Ÿ

  Go çš„ `map` åº•å±‚æ˜¯ **å“ˆå¸Œè¡¨**ï¼Œæ•°æ®æŒ‰å“ˆå¸Œå‡½æ•°åˆ†å¸ƒåœ¨ä¸åŒçš„æ¡¶ï¼ˆbucketï¼‰é‡Œã€‚
    
- å“ˆå¸Œè¡¨çš„ä¸€ä¸ªé‡è¦ç‰¹æ€§å°±æ˜¯ï¼š**é”®å€¼å¯¹æ²¡æœ‰å¤©ç„¶çš„é¡ºåº**ã€‚
    
    - æ’å…¥é¡ºåº â‰  å­˜å‚¨é¡ºåº
        
    - å†…å­˜æ‰©å®¹ï¼ˆrehashï¼‰æ—¶ï¼Œé”®å¯èƒ½ä¼šé‡æ–°åˆ†å¸ƒåˆ°ä¸åŒçš„æ¡¶

```go
m1 := map[string]uint64{ 
	"a": 1,
	"b": 2, 
	"c": 3, 
	"d": 4, 
} 
for k, v := range m1 { 
	fmt.Println("key:", k, "value:", v) 
}
```
è¿è¡Œ 1ï¼š

```makefile
key: b value: 2
key: d value: 4
key: a value: 1
key: c value: 3
```

è¿è¡Œ 2ï¼š

```
key: c value: 3
key: a value: 1
key: d value: 4
key: b value: 2
```