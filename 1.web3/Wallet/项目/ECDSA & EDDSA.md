## 1.ECDSA（**Elliptic Curve Digital Signature Algorithm**）

是基于**椭圆曲线密码学（ECC）**的**数字签名算法**，它在区块链系统中（如 Bitcoin、Ethereum）广泛用于**身份认证、交易签名与验签**。

---

### 一、ECDSA 是什么？

> ECDSA 是一种**非对称加密签名算法**，用于验证消息确实由持有**私钥**的人发出，且**未被篡改**。

它基于两大数学基础：

1. **椭圆曲线密码学（Elliptic Curve Cryptography, ECC）**
    
2. **数字签名算法（DSA）**
    
---

### 二、ECDSA 签名流程（概念版）

ECDSA 的流程分为两部分：**签名（Sign）** 和 **验证（Verify）**
#### 👤 Alice 持有密钥对：

- 私钥：`d`（大整数）
    
- 公钥：`Q = d * G`（G 是椭圆曲线上的生成点）

---
#### ✅ 1. 签名过程（Alice 签署一条消息）

假设 Alice 想签名消息 `m`：

1. 计算消息的哈希值：`z = Hash(m)`
    
2. 随机选取一个整数 `k`（不能重复使用）
    
3. 计算椭圆曲线点：`(x1, y1) = k * G`
    
4. 计算 `r = x1 mod n`，其中 `n` 是 G 的阶（有限域大小）
    
5. 计算 `s = k⁻¹ (z + r·d) mod n`
    
6. 签名结果是 `(r, s)`
---
#### 🔍 2. 验证过程（Bob 使用 Alice 的公钥验证）

Bob 拿到消息 `m` 和签名 `(r, s)`，用 Alice 的公钥 `Q` 验证：

1. 检查 `r, s` 是否在 `[1, n-1]` 范围内
    
2. 计算 `z = Hash(m)`
    
3. 计算 `w = s⁻¹ mod n`
    
4. 计算：
    
    - `u1 = z·w mod n`
        
    - `u2 = r·w mod n`
        
5. 计算椭圆曲线点：`(x1, y1) = u1 * G + u2 * Q`
    
6. 验证：`r == x1 mod n` 成立即签名有效
    

---

### 📌 三、ECDSA 关键特点

|特性|描述|
|---|---|
|🧮 基于 ECC|相比 RSA 提供同等安全性的同时密钥更短|
|🔒 不可逆|无法从签名和消息推导出私钥|
|⚠️ `k` 不能重复|重用 `k` 会泄露私钥（Sony PS3 就犯过）|
|✅ 公钥验签|可以验证消息确实由某个公钥拥有者签发|

## ✅ 总结一句话：

> **ECDSA 是一种安全高效的数字签名方案，它在以太坊和比特币中确保每一笔交易都来自合法的私钥持有者。**

---
## 二、ECDSA
> **EdDSA**（**Edwards-curve Digital Signature Algorithm**）是一种基于**Edwards 曲线**的数字签名算法。

它的主要特点是：

- **安全性高**（抗侧信道攻击）
    
- **签名快、验证快**
    
- **使用固定 `k` 值（可预测、避免重用攻击）**
    
- 通常配合曲线 **Ed25519** 使用（最常见变体）

|对比项|EdDSA（Ed25519）|ECDSA（secp256k1）|
|---|---|---|
|使用曲线|Edwards（如 Ed25519）|Weierstrass（如 secp256k1）|
|`k` 随机值|✅ 自动从私钥和消息中确定（确定性）|❌ 手动生成，必须随机|
|安全性|更抗侧信道攻击、抗实现失误|容易出错（如 `k` 重用泄私钥）|
|性能|签名快，验证快|签名慢，验证慢|
|签名长度|固定 64 字节|通常 65 字节（含 v 值）|
|实现复杂度|相对更简单、更稳健|更依赖于开发者正确实现|
### 🧠 四、EdDSA 使用流程（Ed25519）

`1. 生成密钥对：    - 私钥：32 字节（随机）    - 公钥：通过 Curve25519 派生  2. 签名消息：    - 输入：消息 + 私钥    - 处理：      a. 使用 SHA-512 生成 nonce（防止侧信道攻击）      b. 计算签名值（r, s）    - 输出：64 字节签名  3. 验证签名：    - 输入：消息 + 公钥 + 签名    - 用 Curve25519 和 SHA-512 验证是否合法`

| 区块链            | 是否使用 EdDSA                        | 说明  |
| -------------- | --------------------------------- | --- |
| ✅ **Solana**   | 使用 `Ed25519` 做交易签名                |     |
| ✅ **StarkNet** | 使用 `EdDSA` + 特定椭圆曲线（非 Ed25519）    |     |
| ✅ **Algorand** | 默认采用 EdDSA 签名                     |     |
| ❌ Ethereum     | 使用 `ECDSA/secp256k1`              |     |
| ❌ Bitcoin      | 使用 `ECDSA/secp256k1`，正在引入 Schnorr |     |
EdDSA 是比 ECDSA 更安全、更高性能的现代数字签名算法，尤其在侧信道防护和签名速度方面表现优异。它正在被 Solana、StarkNet、Algorand 等现代区块链广泛采用。